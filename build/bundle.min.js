!function(){"use strict";function e(e,t){return e[t.offset++]}function t(e,t){return e[t.offset++]|e[t.offset++]<<8}function n(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function i(e,t){return n(e,t)>>>0}const s=new Int32Array(2),r=new Float32Array(s.buffer),o=new Float64Array(s.buffer);function a(n,s){const r=n[s.offset++];let o;r<192?o=31&r:217===r?o=e(n,s):218===r?o=t(n,s):219===r&&(o=i(n,s));const a=function(e,t,n){for(var i="",s=0,r=t,o=t+n;r<o;r++){var a=e[r];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(s=(7&a)<<18|(63&e[++r])<<12|(63&e[++r])<<6|(63&e[++r])<<0)>=65536?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s):i+=String.fromCharCode((15&a)<<12|(63&e[++r])<<6|(63&e[++r])<<0):i+=String.fromCharCode((31&a)<<6|63&e[++r]):i+=String.fromCharCode(a)}return i}(n,s.offset,o);return s.offset+=o,a}function l(a,l){const d=a[l.offset++];return d<128?d:202===d?function(e,t){return s[0]=n(e,t),r[0]}(a,l):203===d?function(e,t){return s[0]=n(e,t),s[1]=n(e,t),o[0]}(a,l):204===d?e(a,l):205===d?t(a,l):206===d?i(a,l):207===d?function(e,t){const n=i(e,t);return i(e,t)*Math.pow(2,32)+n}(a,l):208===d?function(t,n){return e(t,n)<<24>>24}(a,l):209===d?function(e,n){return t(e,n)<<16>>16}(a,l):210===d?n(a,l):211===d?function(e,t){const s=i(e,t);return n(e,t)*Math.pow(2,32)+s}(a,l):d>223?-1*(255-d+1):void 0}const d=13;function h(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}function u(e,t,n){for(var i=0,s=0,r=n.length;s<r;s++)(i=n.charCodeAt(s))<128?e.setUint8(t++,i):i<2048?(e.setUint8(t++,192|i>>6),e.setUint8(t++,128|63&i)):i<55296||i>=57344?(e.setUint8(t++,224|i>>12),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i)):(s++,i=65536+((1023&i)<<10|1023&n.charCodeAt(s)),e.setUint8(t++,240|i>>18),e.setUint8(t++,128|i>>12&63),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i))}function c(e,t,n){var i=typeof n,s=0,r=0,o=0,a=0,l=0,d=0;if("string"===i){if(l=function(e){for(var t=0,n=0,i=0,s=e.length;i<s;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}(n),l<32)e.push(160|l),d=1;else if(l<256)e.push(217,l),d=2;else if(l<65536)e.push(218,l>>8,l),d=3;else{if(!(l<4294967296))throw new Error("String too long");e.push(219,l>>24,l>>16,l>>8,l),d=5}return t.push({_str:n,_length:l,_offset:e.length}),d+l}if("number"===i)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(o=n/Math.pow(2,32)>>0,a=n>>>0,e.push(207,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(o=Math.floor(n/Math.pow(2,32)),a=n>>>0,e.push(211,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===i){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((l=n.length)<16)e.push(144|l),d=1;else if(l<65536)e.push(220,l>>8,l),d=3;else{if(!(l<4294967296))throw new Error("Array too large");e.push(221,l>>24,l>>16,l>>8,l),d=5}for(s=0;s<l;s++)d+=c(e,t,n[s]);return d}if(n instanceof Date){var h=n.getTime();return o=Math.floor(h/Math.pow(2,32)),a=h>>>0,e.push(215,0,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),10}if(n instanceof ArrayBuffer){if((l=n.byteLength)<256)e.push(196,l),d=2;else if(l<65536)e.push(197,l>>8,l),d=3;else{if(!(l<4294967296))throw new Error("Buffer too large");e.push(198,l>>24,l>>16,l>>8,l),d=5}return t.push({_bin:n,_length:l,_offset:e.length}),d+l}if("function"==typeof n.toJSON)return c(e,t,n.toJSON());var u=[],p="",f=Object.keys(n);for(s=0,r=f.length;s<r;s++)"function"!=typeof n[p=f[s]]&&u.push(p);if((l=u.length)<16)e.push(128|l),d=1;else if(l<65536)e.push(222,l>>8,l),d=3;else{if(!(l<4294967296))throw new Error("Object too large");e.push(223,l>>24,l>>16,l>>8,l),d=5}for(s=0;s<l;s++)d+=c(e,t,p=u[s]),d+=c(e,t,n[p]);return d}if("boolean"===i)return e.push(n?195:194),1;if("undefined"===i)return e.push(212,0,0),3;throw new Error("Could not encode")}function p(e){var t=[],n=[],i=c(t,n,e),s=new ArrayBuffer(i),r=new DataView(s),o=0,a=0,l=-1;n.length>0&&(l=n[0]._offset);for(var d,h=0,p=0,f=0,g=t.length;f<g;f++)if(r.setUint8(a+f,t[f]),f+1===l){if(h=(d=n[o])._length,p=a+l,d._bin)for(var m=new Uint8Array(d._bin),v=0;v<h;v++)r.setUint8(p+v,m[v]);else d._str?u(r,p,d._str):void 0!==d._float&&r.setFloat64(p,d._float);a+=h,n[++o]&&(l=n[o]._offset)}return s}h.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},h.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},h.prototype._str=function(e){var t=function(e,t,n){for(var i="",s=0,r=t,o=t+n;r<o;r++){var a=e.getUint8(r);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(s=(7&a)<<18|(63&e.getUint8(++r))<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0)>=65536?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s)}else i+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0);else i+=String.fromCharCode((31&a)<<6|63&e.getUint8(++r));else i+=String.fromCharCode(a)}return i}(this._view,this._offset,e);return this._offset+=e,t},h.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},h.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,i=0,s=0,r=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:return n=this._view.getUint8(this._offset),i=this._view.getInt8(this._offset+1),this._offset+=2,[i,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),i=this._view.getInt8(this._offset+2),this._offset+=3,[i,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),i=this._view.getInt8(this._offset+4),this._offset+=5,[i,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return s=this._view.getUint32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,s+r;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return s=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,s+r;case 212:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?void(this._offset+=1):[i,this._bin(1)];case 213:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(2)];case 214:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(4)];case 215:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?(s=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,new Date(s+r)):[i,this._bin(8)];case 216:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")};var f={decode:function(e){const t=new Uint8Array(e),n=Array.from(t);if(n[0]==d){let t={offset:1};return!function(e,t){const n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}(n,t)?l(n,t):a(n,t),function(e,t){void 0===t&&(t=0);var n=new h(e,t),i=n._parse();if(n._offset!==e.byteLength)throw new Error(e.byteLength-n._offset+" trailing bytes");return i}(e,t.offset)}return null},encode:function(e,t){let n=[d],i=p(e),s=p(t),r=new Uint8Array(i.byteLength+s.byteLength+n.length);return r.set(n),r.set(new Uint8Array(i),n.length),r.set(new Uint8Array(s),n.length+i.byteLength),r.buffer}};function g(e,t,n){for(var i=0,s=0,r=n.length;s<r;s++)(i=n.charCodeAt(s))<128?e.setUint8(t++,i):(i<2048?e.setUint8(t++,192|i>>6):(i<55296||57344<=i?e.setUint8(t++,224|i>>12):(s++,i=65536+((1023&i)<<10|1023&n.charCodeAt(s)),e.setUint8(t++,240|i>>18),e.setUint8(t++,128|i>>12&63)),e.setUint8(t++,128|i>>6&63)),e.setUint8(t++,128|63&i))}var m={encode:function(e,t,n){return function(e){var t=[],n=[],i=function e(t,n,i){var s=typeof i,r=0,o=0,a=0,l=0,d=0,h=0;if("string"===s){if((d=function(e){for(var t=0,n=0,i=0,s=e.length;i<s;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||57344<=t?n+=3:(i++,n+=4);return n}(i))<32)t.push(160|d),h=1;else if(d<256)t.push(217,d),h=2;else if(d<65536)t.push(218,d>>8,d),h=3;else{if(!(d<4294967296))throw new Error("String too long");t.push(219,d>>24,d>>16,d>>8,d),h=5}return n.push({h:i,u:d,t:t.length}),h+d}if("number"===s)return Math.floor(i)===i&&isFinite(i)?0<=i?i<128?(t.push(i),1):i<256?(t.push(204,i),2):i<65536?(t.push(205,i>>8,i),3):i<4294967296?(t.push(206,i>>24,i>>16,i>>8,i),5):(a=i/Math.pow(2,32)>>0,l=i>>>0,t.push(207,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):-32<=i?(t.push(i),1):-128<=i?(t.push(208,i),2):-32768<=i?(t.push(209,i>>8,i),3):-2147483648<=i?(t.push(210,i>>24,i>>16,i>>8,i),5):(a=Math.floor(i/Math.pow(2,32)),l=i>>>0,t.push(211,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):(t.push(203),n.push({o:i,u:8,t:t.length}),9);if("object"===s){if(null===i)return t.push(192),1;if(Array.isArray(i)){if((d=i.length)<16)t.push(144|d),h=1;else if(d<65536)t.push(220,d>>8,d),h=3;else{if(!(d<4294967296))throw new Error("Array too large");t.push(221,d>>24,d>>16,d>>8,d),h=5}for(r=0;r<d;r++)h+=e(t,n,i[r]);return h}if(i instanceof Date){var u=i.getTime();return a=Math.floor(u/Math.pow(2,32)),l=u>>>0,t.push(215,0,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),10}if(i instanceof ArrayBuffer){if((d=i.byteLength)<256)t.push(196,d),h=2;else if(d<65536)t.push(197,d>>8,d),h=3;else{if(!(d<4294967296))throw new Error("Buffer too large");t.push(198,d>>24,d>>16,d>>8,d),h=5}return n.push({l:i,u:d,t:t.length}),h+d}if("function"==typeof i.toJSON)return e(t,n,i.toJSON());var c=[],p="",f=Object.keys(i);for(r=0,o=f.length;r<o;r++)"function"!=typeof i[p=f[r]]&&c.push(p);if((d=c.length)<16)t.push(128|d),h=1;else if(d<65536)t.push(222,d>>8,d),h=3;else{if(!(d<4294967296))throw new Error("Object too large");t.push(223,d>>24,d>>16,d>>8,d),h=5}for(r=0;r<d;r++)h+=e(t,n,p=c[r]),h+=e(t,n,i[p]);return h}if("boolean"===s)return t.push(i?195:194),1;if("undefined"===s)return t.push(212,0,0),3;throw new Error("Could not encode")}(t,n,e),s=new ArrayBuffer(i),r=new DataView(s),o=0,a=0,l=-1;0<n.length&&(l=n[0].t);for(var d,h=0,u=0,c=0,p=t.length;c<p;c++)if(r.setUint8(a+c,t[c]),c+1===l){if(h=(d=n[o]).u,u=a+l,d.l)for(var f=new Uint8Array(d.l),m=0;m<h;m++)r.setUint8(u+m,f[m]);else d.h?g(r,u,d.h):void 0!==d.o&&r.setFloat64(u,d.o);a+=h,n[++o]&&(l=n[o].t)}let v=Array.from(new Uint8Array(s));return v.unshift(4),new Uint8Array(v).buffer}({type:2,data:["blueboat_SEND_MESSAGE",{room:n,key:e,data:t}],options:{compress:!0},nsp:"/"})},decode:function(e){function t(e){if(this.t=0,e instanceof ArrayBuffer)this.i=e,this.s=new DataView(this.i);else{if(!ArrayBuffer.isView(e))return null;this.i=e.buffer,this.s=new DataView(this.i,e.byteOffset,e.byteLength)}}t.prototype.g=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.v();return t},t.prototype.M=function(e){for(var t={},n=0;n<e;n++)t[this.v()]=this.v();return t},t.prototype.h=function(e){var t=function(e,t,n){for(var i="",s=0,r=t,o=t+n;r<o;r++){var a=e.getUint8(r);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));65536<=(s=(7&a)<<18|(63&e.getUint8(++r))<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0)?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s)}else i+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++r))<<6|(63&e.getUint8(++r))<<0);else i+=String.fromCharCode((31&a)<<6|63&e.getUint8(++r));else i+=String.fromCharCode(a)}return i}(this.s,this.t,e);return this.t+=e,t},t.prototype.l=function(e){var t=this.i.slice(this.t,this.t+e);return this.t+=e,t},t.prototype.v=function(){if(!this.s)return null;var e,t=this.s.getUint8(this.t++),n=0,i=0,s=0,r=0;if(t<192)return t<128?t:t<144?this.M(15&t):t<160?this.g(15&t):this.h(31&t);if(223<t)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this.s.getUint8(this.t),this.t+=1,this.l(n);case 197:return n=this.s.getUint16(this.t),this.t+=2,this.l(n);case 198:return n=this.s.getUint32(this.t),this.t+=4,this.l(n);case 199:return n=this.s.getUint8(this.t),i=this.s.getInt8(this.t+1),this.t+=2,[i,this.l(n)];case 200:return n=this.s.getUint16(this.t),i=this.s.getInt8(this.t+2),this.t+=3,[i,this.l(n)];case 201:return n=this.s.getUint32(this.t),i=this.s.getInt8(this.t+4),this.t+=5,[i,this.l(n)];case 202:return e=this.s.getFloat32(this.t),this.t+=4,e;case 203:return e=this.s.getFloat64(this.t),this.t+=8,e;case 204:return e=this.s.getUint8(this.t),this.t+=1,e;case 205:return e=this.s.getUint16(this.t),this.t+=2,e;case 206:return e=this.s.getUint32(this.t),this.t+=4,e;case 207:return s=this.s.getUint32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,s+r;case 208:return e=this.s.getInt8(this.t),this.t+=1,e;case 209:return e=this.s.getInt16(this.t),this.t+=2,e;case 210:return e=this.s.getInt32(this.t),this.t+=4,e;case 211:return s=this.s.getInt32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,s+r;case 212:return i=this.s.getInt8(this.t),this.t+=1,0===i?void(this.t+=1):[i,this.l(1)];case 213:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(2)];case 214:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(4)];case 215:return i=this.s.getInt8(this.t),this.t+=1,0===i?(s=this.s.getInt32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,new Date(s+r)):[i,this.l(8)];case 216:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(16)];case 217:return n=this.s.getUint8(this.t),this.t+=1,this.h(n);case 218:return n=this.s.getUint16(this.t),this.t+=2,this.h(n);case 219:return n=this.s.getUint32(this.t),this.t+=4,this.h(n);case 220:return n=this.s.getUint16(this.t),this.t+=2,this.g(n);case 221:return n=this.s.getUint32(this.t),this.t+=4,this.g(n);case 222:return n=this.s.getUint16(this.t),this.t+=2,this.M(n);case 223:return n=this.s.getUint32(this.t),this.t+=4,this.M(n)}throw new Error("Could not parse")};const n=function(e){var n=new t(e=e.slice(1)),i=n.v();return n.t===e.byteLength?i:null}(e);return n?.data?.[1]}};class v extends EventTarget{constructor(e){super(),this.socket=null,this.hasFired=!1,this.transportType="unknown",this.blueboatRoomId=null,this.cheat=e}getSocket(){let e=this;if(Object.isFrozen(WebSocket)){let t=setInterval((()=>{var n,i,s,r,o;let a=null===(o=null===(r=null===(s=null===(i=null===(n=null===window||void 0===window?void 0:window.stores)||void 0===n?void 0:n.network)||void 0===i?void 0:i.room)||void 0===s?void 0:s.connection)||void 0===r?void 0:r.transport)||void 0===o?void 0:o.ws;a&&(e.registerSocket(a),clearInterval(t))}),100)}else WebSocket.prototype._send=WebSocket.prototype.send,WebSocket.prototype.send=function(t){if(this.url.startsWith("ws://localhost"))return this._send(t);if(e.registerSocket(this),e.socket&&(e.socket._send(t),"blueboat"==e.transportType)){let n=m.decode(t);n.roomId&&(e.blueboatRoomId=n.roomId),n.room&&(e.blueboatRoomId=n.room),e.blueboatRoomId||e.cheat.log("Room ID: ",e.blueboatRoomId)}}}registerSocket(e){if(this.hasFired)return;this.socket=e,this.hasFired=!0,this.dispatchEvent(new CustomEvent("socket",{detail:e})),"stores"in unsafeWindow?this.transportType="colyseus":this.transportType="blueboat";let t=this;e.addEventListener("message",(e=>{let n;if(n="colyseus"==this.transportType?f.decode(e.data):m.decode(e.data),n&&(t.dispatchEvent(new CustomEvent("recieveMessage",{detail:n})),"object"==typeof n&&"changes"in n)){let e=function(e){let t=[];for(let n of e.changes){let i={},s=n[1].map((t=>e.values[t]));for(let e=0;e<s.length;e++)i[s[e]]=n[2][e];t.push({id:n[0],data:i})}return t}(n);t.dispatchEvent(new CustomEvent("recieveChanges",{detail:e}))}}))}sendData(e,t){if(!this.socket)return;if(!this.blueboatRoomId&&"blueboat"==this.transportType)return this.cheat.log("Room ID not found, can't send data");let n;n="colyseus"==this.transportType?f.encode(e,t):m.encode(e,t,this.blueboatRoomId),this.socket.send(n)}}class y{constructor(){this.keys=new Set,this.binds=[],this.addListeners()}addListeners(){window.addEventListener("keydown",(e=>{this.keys.add(e.key.toLowerCase()),this.checkBinds(e)})),window.addEventListener("keyup",(e=>{this.keys.delete(e.key.toLowerCase())})),window.addEventListener("blur",(()=>{this.keys.clear()}))}checkBinds(e){var t;if(!e.repeat)for(let n of this.binds)n.keys.has(e.key.toLowerCase())&&0!=n.keys.size&&(n.exclusive&&n.keys.size!=this.keys.size||Array.from(n.keys).every((e=>this.keys.has(e)))&&(null===(t=n.callback)||void 0===t||t.call(n)))}registerBind(e){this.binds.includes(e)||this.binds.push(e)}removeBind(e){this.binds.includes(e)&&this.binds.splice(this.binds.indexOf(e),1)}clearBinds(){this.binds=[]}}class b extends EventTarget{constructor(e,t){super(),this.group=null,this.options=null,this.element=null,this.type="element",this.group=e,this.options=t}remove(){var e;null===(e=this.element)||void 0===e||e.remove(),this.group.elements.splice(this.group.elements.indexOf(this),1)}}class w extends b{constructor(e,t){super(e,t),this.type="text",this.element=document.createElement("div"),this.element.classList.add("text"),this.element.innerText=this.options.text}set text(e){this.element.innerText=e}get text(){return this.element.innerText}}class k extends b{constructor(e,t){super(e,t),this.type="groupOpener",this.element=document.createElement("button"),this.element.classList.add("group_opener"),this.element.innerText=this.options.text,this.element.addEventListener("click",(()=>{var e;let t=null!==(e=this.options.direction)&&void 0!==e?e:"right",n="right"==t?"left":"right";this.group.slide("out",t);let i=this.group.menu.getAnyGroup(this.options.openGroup);i&&i.slide("in",n)}))}set text(e){this.element.innerText=e}get text(){return this.element.innerText}}class _ extends b{constructor(e,t){var n,i;super(e,t),this.opacitySlider=null,this.colorPicker=null,this.preview=null,this.type="colorpicker";let s=document.createElement("div");s.innerHTML=`\n            <div class="text">${this.options.text}</div>\n            <div class="colorpicker_wrapper">\n                <div class="colorpicker_opacity_wrapper">\n                    <div class="text">Opacity</div>\n                    <input type="range" min="0" max="255" value="255" class="colorpicker_opacity">\n                </div>\n                <input type="color" value="#ffffff" class="colorpicker_color">\n                <div class="colorpicker_preview"></div>\n            </div>\n        `,s.classList.add("colorpicker"),this.opacitySlider=s.querySelector(".colorpicker_opacity"),this.colorPicker=s.querySelector(".colorpicker_color"),this.preview=s.querySelector(".colorpicker_preview"),this.options.bindVar?this.color=window.cheat.hud.syncedVars.get("cssVars").get(this.options.bindVar):this.options.color&&(this.color=this.options.color),this.opacitySlider.addEventListener("mousedown",(e=>{e.stopPropagation()})),null===(n=this.opacitySlider)||void 0===n||n.addEventListener("input",(()=>{this.updatePreview()})),null===(i=this.colorPicker)||void 0===i||i.addEventListener("input",(()=>{this.updatePreview()})),this.element=s,this.updatePreview()}updatePreview(){let e=this.colorPicker.value,t=parseInt(this.opacitySlider.value);this.preview.style.backgroundColor=e,this.preview.style.opacity=""+t/255,this.options.bindVar&&window.cheat.hud.updateCssVar(this.options.bindVar,this.color),this.dispatchEvent(new CustomEvent("change",{detail:this.color}))}set color(e){let[t,n]=function(e){let[t,n,i,s]=e.slice(5,-1).split(",").map((e=>parseFloat(e.trim())));return[`#${t.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`,s]}(e);this.colorPicker.value=t,this.opacitySlider.value=""+255*n,this.updatePreview()}get color(){let e=this.colorPicker.value,t=parseInt(this.opacitySlider.value);var n,i;return n=e,i=t/255,`rgba(${parseInt(n.slice(1,3),16)}, ${parseInt(n.slice(3,5),16)}, ${parseInt(n.slice(5,7),16)}, ${i})`}}class x{constructor(e){var t;this.capturing=!1,this.keys=new Set,this.actionState="start",this.type="keybindEditor",this.options=e,this.keybindOpener=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 40"><rect width="40" height="26" x="4" y="10" rx="2.038" ry="2.234" style="fill:#000;fill-opacity:1;fill-rule:evenodd;stroke:#fff;stroke-width:8;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"/><rect width="40" height="26" x="4" y="10" rx="2.038" ry="2.234" style="fill:#000;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/><path d="M14 30h19M7 30h5M35 30h6M7 16h4M13 16h4M19 16h4M25 16h4M31 16h4M34 23h4M28 23h4M22 23h4M16 23h4M37 16h4M10 23h4" style="fill:none;fill-opacity:.75;fill-rule:evenodd;stroke:#fff;stroke-width:4;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/></svg>',"image/svg+xml").firstChild,this.keybindOpener.classList.add("keybind_opener"),this.keybindEditor=document.createElement("dialog"),this.keybindEditor.classList.add("keybind_editor_wrapper"),this.keybindEditor.innerHTML=`\n\t\t\t<div class="keybind_editor">\n\t\t\t\t<div class="close">x</div>\n\t\t\t\t<h1 class="keybind_title">${e.title}</h1>\n\t\t\t\t<div class="keybind_controls">\n\t\t\t\t\t<div class="keybind_display"></div>\n\t\t\t\t\t<div class="keybind_exclusive">\n\t\t\t\t\t\t<div class="text">Exclusive?</div>\n\t\t\t\t\t\t<input type="checkbox" class="exclusive" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="action">Start Capture</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;let n=null!==(t=e.exclusive)&&void 0!==t&&t,i=window.cheat.hud.syncedVars.get("keybinds").get(e.id);i?(this.keys=new Set(i.keys),n=i.exclusive):e.keys&&(this.keys=e.keys),n&&this.keybindEditor.querySelector(".exclusive").setAttribute("checked","true"),this.bind={keys:this.keys,exclusive:n,callback:e.callback},window.cheat.keybindManager.registerBind(this.bind),this.updateAction(),this.updateDisplay(),this.addEventListeners()}addEventListeners(){let e=this.keybindEditor.querySelector(".action"),t=this.keybindEditor.querySelector(".close"),n=this.keybindEditor.querySelector(".keybind_display"),i=this.keybindEditor.querySelector(".exclusive");this.keybindOpener.addEventListener("click",(()=>{this.keybindEditor.showModal()})),this.keybindEditor.addEventListener("mousedown",(t=>{t.stopPropagation(),this.capturing&&t.target!=e&&this.endCapture()})),n.addEventListener("mousedown",(e=>{e.stopPropagation(),this.beginCapture()})),t.addEventListener("click",(()=>{this.keybindEditor.close()})),e.addEventListener("click",(()=>{"Start Capture"==this.actionState?this.beginCapture():"End Capture"==this.actionState?this.endCapture():"Reset"==this.actionState&&(this.keys.clear(),this.updateDisplay(),this.updateAction())})),i.addEventListener("change",(()=>{this.bind.exclusive=i.checked,this.syncBind()}))}beginCapture(){this.capturing=!0,this.keys.clear(),this.keybindEditor.querySelector(".keybind_display").innerHTML="Press any key...",document.addEventListener("keydown",this.keybindCapture.bind(this)),this.updateAction()}keybindCapture(e){this.capturing&&(e.preventDefault(),"Escape"!==e.key&&"Enter"!==e.key?(this.keys.add(e.key.toLowerCase()),this.updateDisplay()):this.endCapture())}endCapture(){this.capturing=!1,document.removeEventListener("keydown",this.keybindCapture.bind(this)),this.updateAction(),this.syncBind()}updateDisplay(){let e=this.keybindEditor.querySelector(".keybind_display"),t=Array.from(this.keys);t=t.map((e=>" "===e?"space":e)),e.innerHTML=t.join(" + ")}updateAction(){let e=this.keybindEditor.querySelector(".action");this.capturing?this.actionState="End Capture":0==this.keys.size?this.actionState="Start Capture":this.actionState="Reset",e.innerHTML=this.actionState}attachTo(e){e.appendChild(this.keybindOpener),e.appendChild(this.keybindEditor)}syncBind(){this.options.id&&window.cheat.hud.updateKeybind(this.options.id,{keys:Array.from(this.keys),exclusive:this.bind.exclusive})}}class S extends b{constructor(e,t){var n,i;super(e,t),this.type="button";let s=document.createElement("div");if(s.classList.add("button_wrapper"),s.innerHTML=`\n            <button class="button">${this.options.text}</button>\n        `,this.element=s,this.button=s.querySelector("button"),this.button.addEventListener("click",(()=>{var e;this.dispatchEvent(new CustomEvent("click")),this.options.runFunction&&(null===(e=window.cheat.funcs.get(this.options.runFunction))||void 0===e||e.call(this))})),this.options.keybind){new x({title:null!==(n=t.title)&&void 0!==n?n:`Set keybind for ${this.button.innerText}`,keys:null!==(i=t.defaultKeybind)&&void 0!==i?i:new Set,exclusive:!1,callback:()=>{this.dispatchEvent(new CustomEvent("click"))}}).attachTo(s)}}set text(e){this.button.innerText=e}get text(){return this.button.innerText}}class E extends b{constructor(e,t){var n;super(e,t),this.input=null,this.type="textInput";let i=document.createElement("div");i.innerHTML=`\n            <div class="text">${this.options.text}</div>\n            <input type="text" class="textinput" placeholder="${null!==(n=this.options.placeholder)&&void 0!==n?n:""}">\n        `,i.classList.add("textinput_wrapper"),this.element=i,this.input=i.querySelector("input"),this.input.addEventListener("input",(()=>{this.dispatchEvent(new CustomEvent("input",{detail:this.text}))}))}set text(e){this.input.value=e}get text(){return this.input.value}}class C extends b{constructor(e,t){var n,i,s;super(e,t),this.type="toggle";let r=document.createElement("div");if(r.innerHTML='\n\t\t\t<button class="toggle"></button>\n\t\t',r.classList.add("toggle_wrapper"),t.keybind){let e={title:null!==(n=t.title)&&void 0!==n?n:"Set keybind for toggle",keys:null!==(i=t.defaultKeybind)&&void 0!==i?i:new Set,exclusive:!1,callback:()=>{this.toggle()}};t.keybindId&&(e.id=t.keybindId),new x(e).attachTo(r)}this.enabled=null!==(s=this.options.default)&&void 0!==s&&s,this.element=r,this.button=r.querySelector("button"),this._textEnabled=this.options.textEnabled,this._textDisabled=this.options.textDisabled,this.updateButton(),this.button.addEventListener("keydown",(e=>e.preventDefault())),this.button.addEventListener("click",(()=>{this.toggle()}))}updateButton(){this.button.innerHTML=this.enabled?this._textEnabled:this._textDisabled,this.button.classList.toggle("enabled",this.enabled)}toggle(){this.enabled=!this.enabled,this.updateButton(),this.options.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.enabled),this.dispatchEvent(new CustomEvent("change",{detail:this.enabled}))}get value(){var e;return null!==(e=this.enabled)&&void 0!==e&&e}set value(e){this.enabled=e,this.updateButton()}get textEnabled(){return this._textEnabled}set textEnabled(e){this._textEnabled=e,this.updateButton()}get textDisabled(){return this._textDisabled}set textDisabled(e){this._textDisabled=e,this.updateButton()}}class I extends b{constructor(e,t){super(e,t),this.type="dropdown",this.element=document.createElement("div"),this.element.classList.add("dropdown_wrapper"),this.element.innerHTML=`\n\t\t\t<div class="text">${t.text}</div>\n\t\t\t<select class="dropdown">\n\t\t\t\t${t.options.map((e=>`<option value="${e}" ${e===t.default?"selected":""}>\n\t\t\t\t\t\t${e}\n\t\t\t\t\t</option>`)).join("")}\n\t\t\t</select>\n\t\t`,this.select=this.element.querySelector(".dropdown"),this.select.addEventListener("keydown",(e=>e.preventDefault())),this.select.addEventListener("change",(()=>{t.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.select.value),this.dispatchEvent(new CustomEvent("change",{detail:this.select.value}))}))}addOption(e){let t=document.createElement("option");t.value=e,t.innerText=e,this.select.appendChild(t)}removeOption(e){let t=this.select.querySelector(`option[value="${e}"]`);t&&this.select.removeChild(t),this.select.value===e&&(this.select.value=this.select.options[0].value)}setOptions(e){this.select.innerHTML="",e.forEach((e=>{this.addOption(e)}))}get value(){return this.select.value}set value(e){this.select.value=e}}class M extends b{constructor(e,t){var n;super(e,t),this.type="slider";let i=document.createElement("div");i.classList.add("slider_wrapper"),i.innerHTML=`\n\t\t\t<div class = "text">${t.text}</div>\n\t\t\t<input type = "range" min = "${t.min}" max = "${t.max}" value = "${null!==(n=t.default)&&void 0!==n?n:0}" class = "slider">\n\t\t`,this.slider=i.querySelector(".slider"),this.element=i,this.slider.addEventListener("mousedown",(e=>{e.stopPropagation()})),this.slider.addEventListener("input",(()=>{this.options.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.slider.value),this.dispatchEvent(new CustomEvent("change",{detail:this.slider.value}))}))}set value(e){this.slider.value=e.toString()}get value(){return Number(this.slider.value)}}class U{constructor(e,t,n,i=!1){this.name="",this.hideTimeout=null,this.element=null,this.isRoot=!1,this.groups=[],this.parentGroup=null,this.elements=[],this.menu=null,this.menu=e,this.parentGroup=t,this.name=n,this.isRoot=i,this.init()}init(){var e,t;let n=document.createElement("div");n.classList.add("group"),this.isRoot||(n.style.display="none"),this.element=n,null===(t=null===(e=this.menu)||void 0===e?void 0:e.element)||void 0===t||t.appendChild(n),this.isRoot||this.addElement("groupopener",{text:"Back",openGroup:this.parentGroup.name,direction:"right"})}addElement(e,t){var n;let i;switch(e.toLowerCase()){case"text":i=new w(this,t);break;case"groupopener":i=new k(this,t);break;case"colorpicker":i=new _(this,t);break;case"button":i=new S(this,t);break;case"textinput":i=new E(this,t);break;case"toggle":i=new C(this,t);break;case"dropdown":i=new I(this,t);break;case"slider":i=new M(this,t);break;default:console.error(`Unknown element type: ${e}`)}return i?(null===(n=this.element)||void 0===n||n.appendChild(i.element),this.elements.push(i),i):null}slide(e,t){this.hideTimeout&&clearTimeout(this.hideTimeout),this.element.style.animation=`slide_${e}_${t} both 0.5s`,"in"==e?this.element.style.display="flex":"out"==e&&(this.hideTimeout=setTimeout((()=>this.element.style.display="none"),500))}createGroup(e){let t=this.menu.getAnyGroup(e);if(t)return t;let n=new U(this.menu,this,e);return this.groups.push(n),this.menu.groups.push(n),this.addElement("groupopener",{text:e,openGroup:e,direction:"left"}),n}group(e){for(let t=0;t<this.groups.length;t++)if(this.groups[t].name==e)return this.groups[t];return null}remove(){var e,t;null===(e=this.element)||void 0===e||e.remove(),null===(t=this.parentGroup)||void 0===t||t.groups.splice(this.parentGroup.groups.indexOf(this),1),this.menu.groups.splice(this.menu.groups.indexOf(this),1)}clearElements(){for(let e=0;e<this.elements.length;e++){let t=this.elements[e];"groupOpener"!=t.type&&(t.remove(),e--)}}loadFromObject(e){const t=()=>{if(e.groups)for(let t of e.groups){this.createGroup(t.name).loadFromObject(t)}},n=()=>{if(e.elements)for(let t of e.elements)this.addElement(t.type,t.options)};"elementsFirst"==e.order?(n(),t()):(t(),n())}}class L{constructor(e){this.menu=null,this.element=null,this.menu=e,this.init()}init(){var e,t;let n=document.createElement("div");n.classList.add("menu_controls"),n.innerHTML=this.menu.name;let i=document.createElement("div");i.classList.add("menu_minimizer"),this.element=n,this.element.appendChild(i),null===(t=null===(e=this.menu)||void 0===e?void 0:e.element)||void 0===t||t.appendChild(n),this.updateMinimizer(),i.addEventListener("click",(()=>{var e;null===(e=this.menu)||void 0===e||e.minimize(),this.updateMinimizer()}))}updateMinimizer(){var e;if(!this.element)return;let t=this.element.querySelector(".menu_minimizer");t&&(t.innerHTML=(null===(e=this.menu)||void 0===e?void 0:e.minimized)?"+":"-")}}class A{constructor(e,t,n){this.hud=null,this.element=null,this.rootGroup=null,this.name="",this.groups=[],this.minimized=!1,this.transform={top:0,left:0,width:300,height:200,minimized:!1},this.hud=e,this.name=t,n&&(this.transform=n),this.init()}applyTransform(e){var t;this.element&&(e.height<50&&(e.height=50),e.width<50&&(e.width=50),this.element.style.top=`${e.top}px`,this.element.style.left=`${e.left}px`,this.element.style.width=`${e.width}px`,this.element.style.height=`${e.height}px`,this.minimize(null!==(t=e.minimized)&&void 0!==t&&t))}init(){var e;let t=document.createElement("div");t.classList.add("menu"),this.element=t,null===(e=this.hud)||void 0===e||e.element.appendChild(t),this.applyTransform(this.transform),new L(this);let n=new U(this,null,"root",!0);this.rootGroup=n,this.groups.push(n),n.element&&this.element.appendChild(n.element),this.addListeners()}addListeners(){if(!this.element)return;let e=!1,t={x:0,y:0},n=0;this.element.addEventListener("mousedown",(i=>{e=!0,t.x=i.clientX,t.y=i.clientY,n=0})),window.addEventListener("mouseup",(()=>{e=!1})),new ResizeObserver((t=>{0!=t[0].contentRect.width&&0!=t[0].contentRect.height&&(e=!1,this.transform.width=t[0].contentRect.width,this.minimized||(this.transform.height=t[0].contentRect.height),this.syncTransform())})).observe(this.element),window.addEventListener("mousemove",(i=>{if(!e)return;if(n+=Math.abs(i.clientX-t.x)+Math.abs(i.clientY-t.y),n<10)return;let s=i.clientX-t.x,r=i.clientY-t.y;this.element.style.left=`${this.element.offsetLeft+s}px`,this.element.style.top=`${this.element.offsetTop+r}px`,this.transform.top=this.element.offsetTop,this.transform.left=this.element.offsetLeft,this.syncTransform(),this.element.offsetLeft<0&&(this.element.style.left="0px"),this.element.offsetTop<0&&(this.element.style.top="0px"),this.element.offsetLeft+this.element.offsetWidth>window.innerWidth&&(this.element.style.left=window.innerWidth-this.element.offsetWidth+"px"),this.element.offsetTop+this.element.offsetHeight>window.innerHeight&&(this.element.style.top=window.innerHeight-this.element.offsetHeight+"px"),t.x=i.clientX,t.y=i.clientY}))}syncTransform(){this.hud.updateMenuTransform(this.name,this.transform)}createGroup(e){return this.rootGroup.createGroup(e)}group(e){return this.rootGroup.group(e)}addElement(e,t){return this.rootGroup.addElement(e,t)}getAnyGroup(e){for(let t of this.groups)if(t.name==e)return t;return null}remove(){var e;null===(e=this.element)||void 0===e||e.remove(),this.hud.menus.splice(this.hud.menus.indexOf(this),1)}minimize(e=null){this.minimized=null==e?!this.minimized:e,this.element.classList.toggle("minimized",this.minimized),this.transform.minimized=this.minimized,this.syncTransform()}loadFromObject(e){this.rootGroup.loadFromObject(e)}}const P=new Map([["menu-bg-color","rgba(0, 0, 0, 0.5)"],["menu-border-color","rgba(0, 0, 0, 0)"],["text-color","rgba(255, 255, 255, 1)"],["button-bg-color","rgba(0, 0, 0, 0.5)"],["button-border-color","rgba(255, 255, 255, 1)"],["menu-controls-bg-color","rgba(0, 0, 255, 0.5)"],["menu-controls-text-color","rgba(255, 255, 255, 1)"],["textinput-border-color","rgba(255, 255, 255, 1)"],["textinput-bg-color","rgba(0, 0, 0, 0.5)"],["toggle-bg-color","rgba(0, 0, 0, 0.5)"],["toggle-border-color","rgba(255, 255, 255, 1)"],["dropdown-bg-color","rgba(0, 0, 0, 0.5)"],["dropdown-border-color","rgba(255, 255, 255, 1)"],["keybind-editor-bg-color","rgba(0, 0, 0, 0.75)"],["keybind-editor-border-color","rgba(255, 255, 255, 1)"]]),T=new Map([["HUD Customization",{top:10,left:10,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}],["Devtools",{top:window.innerHeight/2+10,left:10,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!0}],["General Cheats",{top:10,left:window.innerWidth/3+20,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}],["Cheats for gamemodes",{top:10,left:window.innerWidth/3*2+30,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}]]),B=new Map([]),O={menus:[{name:"HUD Customization",groups:[{name:"General",order:"elementsFirst",elements:[{type:"colorpicker",options:{text:"Text Color",bindVar:"text-color"}}],groups:[{name:"Menu Appearance",elements:[{type:"colorpicker",options:{text:"Menu Background Color",bindVar:"menu-bg-color"}},{type:"colorpicker",options:{text:"Menu Border Color",bindVar:"menu-border-color"}}]},{name:"Menu Controls Appearance",elements:[{type:"colorpicker",options:{text:"Menu Controls Background Color",bindVar:"menu-controls-bg-color"}},{type:"colorpicker",options:{text:"Menu Controls Text Color",bindVar:"menu-controls-text-color"}}]},{name:"Keybind Editor Appearance",elements:[{type:"colorpicker",options:{text:"Keybind Editor Background Color",bindVar:"keybind-editor-bg-color"}},{type:"colorpicker",options:{text:"Keybind Editor Border Color",bindVar:"keybind-editor-border-color"}}]}]},{name:"Elements",groups:[{name:"Buttons",elements:[{type:"colorpicker",options:{text:"Button Background Color",bindVar:"button-bg-color"}},{type:"colorpicker",options:{text:"Button Border Color",bindVar:"button-border-color"}}]},{name:"Text Inputs",elements:[{type:"colorpicker",options:{text:"Text Input Background Color",bindVar:"textinput-bg-color"}},{type:"colorpicker",options:{text:"Text Input Border Color",bindVar:"textinput-border-color"}}]},{name:"Toggles",elements:[{type:"colorpicker",options:{text:"Toggle Background Color",bindVar:"toggle-bg-color"}},{type:"colorpicker",options:{text:"Toggle Border Color",bindVar:"toggle-border-color"}}]},{name:"Dropdowns",elements:[{type:"colorpicker",options:{text:"Dropdown Background Color",bindVar:"dropdown-bg-color"}},{type:"colorpicker",options:{text:"Dropdown Border Color",bindVar:"dropdown-border-color"}}]}]}],elements:[{type:"button",options:{text:"Reset settings",runFunction:"resetSettings"}}]}]};class D{constructor(){this.canvas=document.createElement("canvas"),this.canvas.classList.add("gc_overlay_canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,window.addEventListener("resize",(()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}))}get context(){return this.canvas.getContext("2d")}}class W{constructor(e){this.element=null,this.menus=[],this.cssVarsSheet=null,window.cheat.hud=this,this.syncedVars=new Map,this.cheat=e,this.cheat.funcs.set("resetSettings",this.resetSettings.bind(this)),this.loadSyncedVar("cssVars",P),this.loadSyncedVar("menuTransforms",T),this.loadSyncedVar("keybinds",B),this.updateCssVars(),this.init(),this.loadFromObject(O),this.addToggle()}resetSettings(){confirm("Setting updates will only take place after you reload the page, are you sure you want to reset settings?")&&(GM_deleteValue("cssVars"),GM_deleteValue("menuTransforms"),GM_deleteValue("keybinds"))}addToggle(){this.cheat.keybindManager.registerBind({keys:new Set(["\\"]),exclusive:!1,callback:()=>{this.element&&(this.element.style.display="none"==this.element.style.display?"":"none")}})}createMenu(e){var t;let n=this.menu(e);if(n)return n;let i=null===(t=this.syncedVars.get("menuTransforms"))||void 0===t?void 0:t.get(e),s=new A(this,e,i);return this.menus.push(s),s}menu(e){for(let t=0;t<this.menus.length;t++)if(this.menus[t].name==e)return this.menus[t];return null}loadSyncedVar(e,t){let n=GM_getValue(e,"{}"),i=JSON.parse(n);for(let[e,n]of t)i[e]||(i[e]=n);this.syncedVars.set(e,new Map(Object.entries(i)))}updateCssVar(e,t){var n,i;null===(n=this.syncedVars.get("cssVars"))||void 0===n||n.set(e,t),this.updateCssVars();let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("cssVars"))&&void 0!==i?i:[]));GM_setValue("cssVars",s)}updateMenuTransform(e,t){var n,i;null===(n=this.syncedVars.get("menuTransforms"))||void 0===n||n.set(e,t);let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("menuTransforms"))&&void 0!==i?i:[]));GM_setValue("menuTransforms",s)}updateKeybind(e,t){var n,i;console.log(e,t),null===(n=this.syncedVars.get("keybinds"))||void 0===n||n.set(e,t);let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("keybinds"))&&void 0!==i?i:[]));GM_setValue("keybinds",s)}updateCssVars(){var e;this.cssVarsSheet||(this.cssVarsSheet=new CSSStyleSheet,document.adoptedStyleSheets=[...document.adoptedStyleSheets,this.cssVarsSheet]);let t=":root {\n";for(let[n,i]of null!==(e=this.syncedVars.get("cssVars"))&&void 0!==e?e:[])t+=`\t--${n}: ${i};\n`;t+="}",this.cssVarsSheet.replaceSync(t)}init(){let e=new CSSStyleSheet;e.replaceSync("#gc_hud {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 999999999999;\r\n    pointer-events: none;\r\n    color: var(--text-color);\r\n}\r\n\r\n#gc_hud .menu_controls {\r\n    width: 100%;\r\n    height: 20px;\r\n    background-color: var(--menu-controls-bg-color);\r\n    color: var(--menu-controls-text-color);\r\n    border-radius: 5px 5px 0px 0px;\r\n    text-align: center;\r\n    position: relative;\r\n}\r\n\r\n#gc_hud .menu_minimizer {\r\n    margin-left: 20px;\r\n    margin-right: 20px;\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    user-select: none;\r\n}\r\n\r\n#gc_hud .menu {\r\n    pointer-events: auto;\r\n    position: absolute;\r\n    background-color: var(--menu-bg-color);\r\n    display: inline-block;\r\n    border-radius: 5px;\r\n    overflow-x: hidden;\r\n    overflow-y: hidden;\r\n    resize: both;\r\n    width: 300px;\r\n    height: 200px;\r\n    outline: 3px solid var(--menu-border-color);\r\n}\r\n\r\n#gc_hud .menu.minimized {\r\n    height: 20px !important;\r\n    overflow-y: hidden;\r\n    resize: horizontal;\r\n}\r\n\r\n#gc_hud .group {\r\n    margin: 0px;\r\n    padding: 0px;\r\n    width: 100%;\r\n    /* allocate some space at the top and bottom */\r\n    height: calc(100% - 40px); \r\n    position: absolute;\r\n    top: 20px;\r\n    left: 0;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n}\r\n\r\n#gc_hud .button, #gc_hud .group_opener {\r\n    background-color: var(--button-bg-color);\r\n    border: 1px solid var(--button-border-color);\r\n}\r\n\r\n#gc_hud .toggle {\r\n    background-color: var(--toggle-bg-color);\r\n    border: 1px solid var(--toggle-border-color);\r\n}\r\n\r\n#gc_hud .button, #gc_hud .toggle, #gc_hud .group_opener {\r\n    border-radius: 5px;\r\n    padding: 5px;\r\n    margin: 5px;\r\n    cursor: pointer;\r\n    width: 90%;\r\n    transition: transform 0.2s ease-in-out;\r\n}\r\n\r\n/* make it bounce smaller when clicked */\r\n#gc_hud .button:active, #gc_hud .toggle:active, #gc_hud .group_opener:active {\r\n    transform: scale(0.93);\r\n}\r\n\r\n#gc_hud .colorpicker {\r\n    width: 100%;\r\n}\r\n\r\n#gc_hud .colorpicker_wrapper {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .colorpicker_opacity_wrapper {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .colorpicker_preview {\r\n    width: 50px;\r\n    height: 50px;\r\n    border-radius: 5px;\r\n    opacity: 1;\r\n}\r\n\r\n#gc_hud .text {\r\n    text-align: center;\r\n    width: 100%;\r\n}\r\n\r\n#gc_hud .textinput_wrapper, #gc_hud .dropdown_wrapper, #gc_hud .slider_wrapper {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .textinput {\r\n    width: 90%;\r\n    border-radius: 5px;\r\n    border: 1px solid var(--textinput-border-color);\r\n    background-color: var(--textinput-bg-color);\r\n    color: var(--text-color);\r\n    padding: 5px;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .dropdown {\r\n    width: 90%;\r\n    border-radius: 5px;\r\n    border: 1px solid var(--dropdown-border-color);\r\n    background-color: var(--dropdown-bg-color);\r\n    color: var(--text-color);\r\n    padding: 5px;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .toggle_wrapper, #gc_hud .button_wrapper {\r\n    width: 90%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    padding: 0px;\r\n}\r\n\r\n#gc_hud .toggle, #gc_hud .button {\r\n    /* make it take up as much space as possible */\r\n    width: 100%;\r\n    margin-left: 0px;\r\n    margin-right: 0px;\r\n}\r\n\r\n#gc_hud .keybind_opener {\r\n    width: 30px;\r\n    height: 30px;\r\n    font-size: 30px;\r\n    margin-left: 10px;\r\n}\r\n\r\n#gc_hud .keybind_editor_wrapper {\r\n    background-color: var(--keybind-editor-bg-color);\r\n    border: 3px solid var(--keybind-editor-border-color);\r\n    border-radius: 8px;\r\n}\r\n\r\n#gc_hud .keybind_editor {\r\n    width: 50vw;\r\n    height: 50vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    color: var(--text-color);\r\n}\r\n\r\n#gc_hud .close {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    width: 20px;\r\n    height: 20px;\r\n    font-size: 20px;\r\n    cursor: pointer;\r\n    user-select: none;\r\n}\r\n\r\n#gc_hud .keybind_title {\r\n    font-size: 40px;\r\n    text-align: center;\r\n}\r\n\r\n#gc_hud .keybind_controls {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .keybind_display {\r\n    border: 3px solid white;\r\n    min-width: 300px;\r\n    border-radius: 5px;\r\n    height: 50px;\r\n    text-align: center;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    cursor: pointer;\r\n}\r\n\r\n#gc_hud .keybind_exclusive {\r\n    display: flex;\r\n}\r\n\r\n#gc_hud .keybind_exclusive .text {\r\n    margin-right: 10px;\r\n}\r\n\r\n#gc_hud .keybind_editor .action {\r\n    cursor: pointer;\r\n}\r\n\r\n#gc_hud .slider {\r\n    width: 90%;\r\n    margin: 5px;\r\n}\r\n\r\n.gc_overlay_canvas {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: 9999;\r\n    pointer-events: none;\r\n}\r\n\r\n@keyframes slide_out_left {\r\n    0% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(-100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n}\r\n\r\n@keyframes slide_out_right {\r\n    0% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n}\r\n\r\n@keyframes slide_in_left {\r\n    0% {\r\n        transform: translateX(-100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n}\r\n\r\n@keyframes slide_in_right {\r\n    0% {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n}\r\n\r\n@keyframes idle {}"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e];let t=document.createElement("div");t.id="gc_hud",this.element=t,document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(t)})),this.updateCssVars()}loadFromObject(e){for(let t of e.menus){this.createMenu(t.name).loadFromObject(t)}}createOverlayCanvas(){var e;let t=new D;return null===(e=document.body)||void 0===e||e.appendChild(t.canvas),t}}const G={menus:[{name:"Devtools",elements:[{type:"toggle",options:{textEnabled:"Stop logging incoming messages",textDisabled:"Log incoming messages",default:!1,runFunction:"logIncomingMessages"}},{type:"button",options:{text:"Log closest device",runFunction:"logClosestDevice"}}]}]};class N{constructor(){this.name="Gimkit Cheat Devtools",this.hudAddition=G,this.loggingIncomingMessages=!1,this.funcs=new Map([["logIncomingMessages",e=>{this.loggingIncomingMessages=e}],["logClosestDevice",()=>{this.logClosestDevice()}]])}init(e){e.socketHandler.addEventListener("recieveMessage",(t=>{this.loggingIncomingMessages&&e.log("Incoming message",t.detail)}))}logClosestDevice(){var e,t,n,i,s,r,o,a;let l=null===(s=null===(i=null===(n=null===(t=null===(e=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===e?void 0:e.phaser)||void 0===t?void 0:t.scene)||void 0===n?void 0:n.worldManager)||void 0===i?void 0:i.devices)||void 0===s?void 0:s.devicesInView,d=null===(a=null===(o=null===(r=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===r?void 0:r.phaser)||void 0===o?void 0:o.mainCharacter)||void 0===a?void 0:a.body,h=null,u=1/0;for(let e of l){if(0==e.interactiveZones.zones.length)continue;let t=Math.sqrt(Math.pow(e.x-d.x,2)+Math.pow(e.y-d.y,2));t<u&&(h=e,u=t)}console.log(h)}}const V={menus:[{name:"General Cheats",elements:[{type:"toggle",options:{textEnabled:"Stop auto answering",textDisabled:"Auto answer",default:!1,runFunction:"setAutoAnswer",keybind:!0,keybindId:"autoAnswer"}}]}]};class F{constructor(){this.name="Autoanswer",this.hudAddition=V,this.autoAnswering=!1,this.funcs=new Map([["setAutoAnswer",e=>{this.autoAnswering=e}]]),this.currentQuestionId="",this.answerDeviceId="",this.questions=[],this.questionIdList=[],this.currentQuestionIndex=0}init(e){e.socketHandler.addEventListener("recieveMessage",(t=>{var n;if("colyseus"!=e.socketHandler.transportType&&"STATE_UPDATE"==(null===(n=t.detail)||void 0===n?void 0:n.key))switch(t.detail.data.type){case"GAME_QUESTIONS":this.questions=t.detail.data.value;break;case"PLAYER_QUESTION_LIST":this.questionIdList=t.detail.data.value.questionList,this.currentQuestionIndex=t.detail.data.value.questionIndex;break;case"PLAYER_QUESTION_LIST_INDEX":this.currentQuestionIndex=t.detail.data.value}})),e.socketHandler.addEventListener("recieveChanges",(e=>{var t,n,i;let s=e.detail;for(let e of s){for(let[t,n]of Object.entries(e.data))"GLOBAL_questions"==t&&(this.questions=JSON.parse(n),this.answerDeviceId=e.id);for(let[s,r]of Object.entries(e.data))s.includes("currentQuestionId")&&s.includes(null===(i=null===(n=null===(t=unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===n?void 0:n.mainCharacter)||void 0===i?void 0:i.id)&&(this.currentQuestionId=r)}})),setInterval((()=>{var t;if(this.autoAnswering)if("colyseus"==e.socketHandler.transportType){if(""==this.currentQuestionId)return;let n=null===(t=this.questions)||void 0===t?void 0:t.find((e=>e._id==this.currentQuestionId));if(!n)return;let i=n.answers.find((e=>e.correct))._id,s={key:"answered",deviceId:this.answerDeviceId,data:{answer:i}};e.socketHandler.sendData("MESSAGE_FOR_DEVICE",s)}else{let t=this.questionIdList[this.currentQuestionIndex],n=this.questions.find((e=>e._id==t)).answers.find((e=>e.correct))._id;e.socketHandler.sendData("QUESTION_ANSWERED",{answer:n,questionId:t})}}),1e3)}}let H=["Unchanged","default_browngreen","default_cyan","default_darkblue","default_darkgreen","default_darkpurple","default_gray","default_grayblue","default_graybrown","default_hotpink","default_lightbrown","default_lightgreen","default_lightpink","default_lightpurple","default_lightyellow","default_lime","default_maroon","default_orange","default_pink","default_red","default_yellow","sunny","glassHalfFull","stripeDoubleGreen","sprinklesRed","dayOne","vortexAgent","echoAgent","grayGradient","mustache","clown","redNinja","redDeliciousApple","polkaDotBlueAndYellow","fadedBlueGradient","whiteAndBlueVerticalStripes","volcanoCracks","pinkPaste","yellowCracksPurple","glyphsYellowBrown","camoBlue","glyphsOrangeBlue","purplePaste","mustacheBrown","mustachePink","polkaDotWhiteAndRed","camoTan","camoGreen","stripeDoublePurple","stripeDoubleRed","stripeDoubleYellow","sprinklesChocolate","coolRedBlueGradient","mountainAndSun","redDinoCostume","pencilPack","corn","luchador","fox","burger","galaxy","cellBlue","cellGold","rockyWest","puzzleRedGreen","puzzleOrangeBlue","puzzleGrayWhite","puzzleGreenBlue","puzzleYellowPurple","pumpkin","ghostCostume","mummy","fifthBirthday","pumpkinPie","feast","frostBuddy","festiveOnesieTan","festiveOnesieRed","festiveOnesieGreen","festiveOnesieBlue","hotChocolate","snowglobe","polkaDotFestive","polkaDotFestiveReverse","mustacheSanta","firework","gift","snowman","detective","yinYang","astroHelmet","hamster","pirate","rockstar","circuitGray","circuitBlue","circuitGreen","roses","heart","zebra","constellationBlackWhite","constellationBlackGreen","constellationPurpleYellow","constellationPinkGreen","constellationYellowPink","squiggles","frozenMummy","leprechaun","evilPlantGreen","evilPlantPink","fisher","rainbowWave","sketch","sketchBlue","bananaSplit","eightBit","gamerGreen","gamerPink","gamerPurple","gamerYellow","graduate","graduateBlue","arcticFox","coffee","partyPineapple","sentryRobot","construction","clock","crashTestDummy"],z=["None","origin_token"];H=H.sort(),z=z.sort();const R={menus:[{name:"General Cheats",groups:[{name:"Cosmetic Picker",elements:[{type:"text",options:{text:"Select cosmetics to apply to your character. These changes are only visible to you."}},{type:"dropdown",options:{text:"Selected Skin",options:H,runFunction:"setSkin",default:"Unchanged"}},{type:"dropdown",options:{text:"Selected Trail",options:z,runFunction:"setTrail",default:"None"}}]}]}]};class j{constructor(){this.name="Cosmetic Picker",this.hudAddition=R,this.funcs=new Map([["setSkin",e=>{this.setSkin(e)}],["setTrail",e=>{this.setTrail(e)}]]),this.skinWaiting=!1,this.trailWaiting=!1,this.customSkin="Unchaged"}init(e){var t,n,i,s,r,o,a,l;(null===(n=null===(t=e.hud.menu("General Cheats"))||void 0===t?void 0:t.group("Cosmetic Picker"))||void 0===n?void 0:n.addElement("textinput",{text:"Other skin input"})).addEventListener("input",(e=>{this.customSkin=e.detail})),(null===(s=null===(i=e.hud.menu("General Cheats"))||void 0===i?void 0:i.group("Cosmetic Picker"))||void 0===s?void 0:s.addElement("button",{text:"Apply Other Skin"})).addEventListener("click",(()=>{this.setSkin(this.customSkin)})),(null===(o=null===(r=e.hud.menu("General Cheats"))||void 0===r?void 0:r.group("Cosmetic Picker"))||void 0===o?void 0:o.addElement("textinput",{text:"Other trail input"})).addEventListener("input",(e=>{this.customSkin=e.detail})),(null===(l=null===(a=e.hud.menu("General Cheats"))||void 0===a?void 0:a.group("Cosmetic Picker"))||void 0===l?void 0:l.addElement("button",{text:"Apply Other Trail"})).addEventListener("click",(()=>{this.setTrail(this.customSkin)}))}setSkin(e){var t,n,i,s,r,o;if("Unchanged"==e)return;if(!("stores"in unsafeWindow)){if(this.skinWaiting)return;let t=setInterval((()=>{"stores"in unsafeWindow&&(this.hasSkinApplied(e)&&clearInterval(t),this.setSkin(e))}),100);return void(this.skinWaiting=!0)}let a=unsafeWindow.stores.phaser,l=null===(t=a.mainCharacter)||void 0===t?void 0:t.id;if(!l)return;let d=`character_${e}`;null===(o=null===(r=null===(s=null===(i=null===(n=a.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(l))||void 0===r?void 0:r.skin)||void 0===o||o.updateSkin(d)}hasSkinApplied(e){var t,n,i,s,r;let o=unsafeWindow.stores.phaser,a=null===(t=o.mainCharacter)||void 0===t?void 0:t.id;if(!a)return;let l=`character_${e}`;return(null===(r=null===(s=null===(i=null===(n=o.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(a))||void 0===r?void 0:r.skin.skinId)==l}setTrail(e){var t,n,i,s,r,o;if(!("stores"in unsafeWindow)){if(this.trailWaiting)return;let t=setInterval((()=>{"stores"in unsafeWindow&&(this.hasSkinApplied(e)&&clearInterval(t),this.setTrail(e))}),100);return void(this.trailWaiting=!0)}let a=unsafeWindow.stores.phaser,l=null===(t=a.mainCharacter)||void 0===t?void 0:t.id;if(!l)return;"None"==e&&(e="");let d=`trail_${e}`;null===(o=null===(r=null===(s=null===(i=null===(n=a.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(l))||void 0===r?void 0:r.characterTrail)||void 0===o||o.updateAppearance(d)}}const $={menus:[{name:"General Cheats",groups:[{name:"Player Highlighter",elements:[{type:"toggle",options:{textEnabled:"Stop Highlighting Teammates",textDisabled:"Highlight Teammates",runFunction:"highlightTeammates",keybind:!0,keybindId:"highlightTeammates"}},{type:"toggle",options:{textEnabled:"Stop Highlighting Enemies",textDisabled:"Highlight Enemies",runFunction:"highlightEnemies",keybind:!0,keybindId:"highlightEnemies"}},{type:"slider",options:{text:"Arrow Distance",min:20,max:750,default:200,runFunction:"setArrowDistance"}}]}]}]};class q{constructor(){this.name="Player Highlighter",this.hudAddition=$,this.funcs=new Map([["highlightTeammates",e=>{this.highlightingTeammates=e}],["highlightEnemies",e=>{this.highlightingEnemies=e}],["setArrowDistance",e=>{this.arrowDistance=e}]]),this.highlightingTeammates=!1,this.highlightingEnemies=!1,this.ctx=null,this.canvas=null,this.arrowDistance=200}init(e){setInterval((()=>{var t,n;(null===(n=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===n?void 0:n.scene)&&(null==this.canvas&&(this.canvas=e.hud.createOverlayCanvas(),this.ctx=this.canvas.context),this.render())}),100)}render(){var e,t,n,i,s,r,o,a,l,d,h;null===(e=this.ctx)||void 0===e||e.clearRect(0,0,null!==(n=null===(t=this.canvas)||void 0===t?void 0:t.canvas.width)&&void 0!==n?n:1920,null!==(s=null===(i=this.canvas)||void 0===i?void 0:i.canvas.height)&&void 0!==s?s:1080);let u=unsafeWindow.stores.phaser,c=u.scene.characterManager.characters,p=u.mainCharacter;for(let[e,t]of c){if(e==p.id)continue;let n=t.teamId!=p.teamId;if(n&&!this.highlightingEnemies)continue;if(!n&&!this.highlightingTeammates)continue;this.ctx.strokeStyle=n?"red":"green",this.ctx.lineWidth=5;let i=Math.atan2(t.body.y-p.body.y,t.body.x-p.body.x),s=Math.sqrt(Math.pow(t.body.x-p.body.x,2)+Math.pow(t.body.y-p.body.y,2)),u=Math.min(s,this.arrowDistance),c={x:Math.cos(i)*u+this.canvas.canvas.width/2,y:Math.sin(i)*u+this.canvas.canvas.height/2},f=i-Math.PI/4*3,g=i+Math.PI/4*3;null===(r=this.ctx)||void 0===r||r.beginPath(),null===(o=this.ctx)||void 0===o||o.moveTo(c.x,c.y),null===(a=this.ctx)||void 0===a||a.lineTo(50*Math.cos(f)+c.x,50*Math.sin(f)+c.y),null===(l=this.ctx)||void 0===l||l.moveTo(c.x,c.y),null===(d=this.ctx)||void 0===d||d.lineTo(50*Math.cos(g)+c.x,50*Math.sin(g)+c.y),null===(h=this.ctx)||void 0===h||h.stroke(),this.ctx.fillStyle="black",this.ctx.font="20px Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(`${t.nametag.name} (${Math.round(s)})`,c.x,c.y)}}}class Q{constructor(){this.name="Cosmetic Picker",this.freecamming=!1,this.freeCamPos={x:0,y:0},this.toggleFreecam=null,this.spectateMenu=null,this.keys=new Set,this.lastPlayers=[]}init(e){let t=e.hud.createMenu("General Cheats").createGroup("Freecam"),n=t.addElement("toggle",{textEnabled:"Stop Freecamming",textDisabled:"Unbind Camera",keybind:!0,keybindId:"toggleFreecam"});n.addEventListener("change",(e=>{this.camHelper?this.enableFreecam(e.detail):n.value=!1}));let i=t.addElement("dropdown",{text:"Spectate Player",options:["None"]});i.addEventListener("change",(e=>{this.spectatePlayer(e.detail)})),this.toggleFreecam=n,this.spectateMenu=i,e.addEventListener("gameLoaded",(()=>{this.camHelper=unsafeWindow.stores.phaser.scene.cameraHelper,setInterval((()=>{this.update()}),1e3/60)})),window.addEventListener("keydown",(e=>{this.freecamming&&e.key.includes("Arrow")&&(e.stopImmediatePropagation(),this.keys.add(e.key))})),window.addEventListener("keyup",(e=>{this.keys.delete(e.key)}))}enableFreecam(e){let t=unsafeWindow.stores.phaser,n=t.scene.cameras.cameras[0];if(e)this.camHelper.stopFollow(),this.freeCamPos.x=n.midPoint.x,this.freeCamPos.y=n.midPoint.y,n.useBounds=!1;else{let e=t.scene.characterManager.characters.get(t.mainCharacter.id).body;this.camHelper.startFollowingObject({object:e}),n.useBounds=!0}this.freecamming=e}spectatePlayer(e){if(this.enableFreecam(!1),"None"==e)return;this.toggleFreecam.value=!0;let t=unsafeWindow.stores.phaser.scene.characterManager.characters;for(let[n,i]of t)if(i.nametag.name==e){this.camHelper.startFollowingObject({object:i.body});break}}update(){this.updateSpectatablePlayers(),this.freecamming&&(this.keys.has("ArrowUp")&&(this.freeCamPos.y-=20),this.keys.has("ArrowDown")&&(this.freeCamPos.y+=20),this.keys.has("ArrowLeft")&&(this.freeCamPos.x-=20),this.keys.has("ArrowRight")&&(this.freeCamPos.x+=20),this.camHelper.goTo(this.freeCamPos))}updateSpectatablePlayers(){var e;let t=unsafeWindow.stores.phaser,n=t.scene.characterManager.characters,i=["None"];for(let[e,s]of n)e!=t.mainCharacter.id&&i.push(s.nametag.name);let s=!0;if(this.lastPlayers.length!=i.length)s=!1;else for(let e=0;e<this.lastPlayers.length;e++)if(this.lastPlayers[e]!=i[e]){s=!1;break}s||(this.lastPlayers=i,null===(e=this.spectateMenu)||void 0===e||e.setOptions(i))}}var Y;!function(e){e.Insurance="insurance",e["Money Per Question"]="moneyPerQuestion",e.Multiplier="multiplier",e["Streak Bonus"]="streakBonus"}(Y||(Y={}));const X={menus:[{name:"Cheats for gamemodes",groups:[{name:"Classic",elements:[{type:"toggle",options:{textEnabled:"Stop Auto Purchasing",textDisabled:"Start Auto Purchasing",default:!1,runFunction:"setAutoPurchasingClassic",keybind:!0,keybindId:"autoPurchasingClassic"}}]}]}]};class J{constructor(){this.name="Classic Script",this.money=0,this.upgradeLevels={insurance:1,moneyPerQuestion:1,multiplier:1,streakBonus:1},this.hudAddition=X,this.autoPurchasing=!1,this.funcs=new Map([["setAutoPurchasingClassic",e=>{this.autoPurchasing=e,this.autoPurchasing&&this.checkAutoBuy()}]]),this.upgradesToGet=[["Streak Bonus",2,20],["Money Per Question",3,100],["Streak Bonus",3,200],["Multiplier",3,300],["Streak Bonus",4,2e3],["Multiplier",4,2e3],["Money Per Question",5,1e4],["Streak Bonus",5,2e4],["Multiplier",5,12e3],["Money Per Question",6,75e3],["Multiplier",6,85e3],["Streak Bonus",6,2e5],["Streak Bonus",7,2e6],["Streak Bonus",8,2e7],["Multiplier",7,7e5],["Money Per Question",9,1e7],["Multiplier",8,65e5],["Streak Bonus",9,2e8],["Multiplier",9,65e6],["Streak Bonus",10,2e9],["Money Per Question",10,1e8],["Multiplier",10,1e9]]}init(e){this.cheat=e,this.cheat.socketHandler.addEventListener("recieveMessage",(e=>{var t,n;if("blueboat"==this.cheat.socketHandler.transportType){if("UPGRADE_LEVELS"==(null===(t=e.detail.data)||void 0===t?void 0:t.type)){this.upgradeLevels=e.detail.data.value;for(let e=0;e<this.upgradesToGet.length;e++){let t=this.upgradesToGet[e];this.upgradeLevels[Y[t[0]]]>=t[1]&&(this.upgradesToGet.splice(e,1),e--)}}"BALANCE"==(null===(n=e.detail.data)||void 0===n?void 0:n.type)&&(this.money=e.detail.data.value,this.checkAutoBuy())}}))}checkAutoBuy(){if(!this.autoPurchasing)return;let e=this.upgradesToGet[0];e&&this.money>=e[2]&&this.purchaseUpgrade(e[0],e[1])}purchaseUpgrade(e,t){this.cheat.log("Purchasing upgrade",e,t),this.cheat.socketHandler.sendData("UPGRADE_PURCHASED",{upgradeName:e,level:t})}}const K={menus:[{name:"Cheats for gamemodes",groups:[{name:"Super Rich Mode",elements:[{type:"toggle",options:{textEnabled:"Stop Auto Purchasing",textDisabled:"Start Auto Purchasing",default:!1,runFunction:"setAutoPurchasingRichMode",keybind:!0,keybindId:"autoPurchasingRichMode"}}]}]}]};class Z extends J{constructor(){super(...arguments),this.name="Rich Mode Script",this.hudAddition=K,this.funcs=new Map([["setAutoPurchasingRichMode",e=>{this.autoPurchasing=e,this.autoPurchasing&&this.checkAutoBuy()}]]),this.upgradesToGet=[["Streak Bonus",2,1e4],["Money Per Question",3,5e3],["Streak Bonus",3,1e5],["Multiplier",3,15e4],["Streak Bonus",4,1e6],["Multiplier",4,1e6],["Money Per Question",5,5e6],["Streak Bonus",5,1e7],["Multiplier",5,6e6],["Money Per Question",6,375e5],["Multiplier",6,425e5],["Streak Bonus",6,1e8],["Streak Bonus",7,1e9],["Streak Bonus",8,1e10],["Multiplier",7,35e7],["Money Per Question",9,5e9],["Multiplier",8,325e7],["Streak Bonus",9,1e11],["Multiplier",9,325e8],["Streak Bonus",10,1e12],["Money Per Question",10,5e10],["Multiplier",10,5e11]]}}class ee{constructor(){this.name="Trust No One Script",this.people=[]}init(e){this.cheat=e;let t=e.hud.createMenu("Cheats for gamemodes").createGroup("Trust No One").addElement("text",{text:"Imposters: Waiting... (only works if you don't join mid-game)"});e.socketHandler.addEventListener("recieveMessage",(e=>{if("blueboat"==this.cheat.socketHandler.transportType&&"IMPOSTER_MODE_PEOPLE"==e.detail.key){this.people=e.detail.data;let n=this.people.filter((e=>"imposter"==e.role));t.text=`Imposter(s): ${n.map((e=>e.name)).join(", ")}`}}))}}const te={menus:[{name:"General Cheats",elements:[{type:"toggle",options:{textEnabled:"Stop instant use",textDisabled:"Instant use",default:!0,runFunction:"setInstantUse",keybind:!0,keybindId:"instantUse"}}]}]};class ne{constructor(){this.name="Instantuse",this.hudAddition=te,this.instantUseEnabled=!0,this.funcs=new Map([["setInstantUse",e=>{this.instantUseEnabled=e}]])}init(e){let t=this;e.keybindManager.registerBind({keys:new Set(["enter"]),exclusive:!1,callback(){t.useNearest()}})}useNearest(){var e,t,n,i,s,r,o,a,l,d;let h=null===(s=null===(i=null===(n=null===(t=null===(e=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===e?void 0:e.phaser)||void 0===t?void 0:t.scene)||void 0===n?void 0:n.worldManager)||void 0===i?void 0:i.devices)||void 0===s?void 0:s.devicesInView,u=null===(a=null===(o=null===(r=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===r?void 0:r.phaser)||void 0===o?void 0:o.mainCharacter)||void 0===a?void 0:a.body;if(!h||!u)return;let c=null,p=1/0;for(let e of h){if(0==e.interactiveZones.zones.length)continue;let t=Math.sqrt(Math.pow(e.x-u.x,2)+Math.pow(e.y-u.y,2));t<p&&(c=e,p=t)}c&&(null===(d=null===(l=null==c?void 0:c.interactiveZones)||void 0===l?void 0:l.onInteraction)||void 0===d||d.call(l))}}function ie(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}const se={"Capture The Flag":[{displayName:"Speed Upgrade",selector:{grantedItemName:"Speed Upgrade"},reusable:!1},{displayName:"Efficiency Upgrade",selector:{grantedItemName:"Efficiency Upgrade"},reusable:!1},{displayName:"Energy Per Question Upgrade",selector:{grantedItemName:"Energy Per Question Upgrade"},reusable:!1},{displayName:"InvisaBits",selector:{grantedItemId:"silver-ore"},reusable:!0}],Tag:[{displayName:"Speed Upgrade",selector:{grantedItemName:"Speed Upgrade"},reusable:!1},{displayName:"Efficiency Upgrade",selector:{grantedItemName:"Efficiency Upgrade"},reusable:!1},{displayName:"Energy Per Question Upgrade",selector:{grantedItemName:"Energy Per Question Upgrade"},reusable:!1},{displayName:"Endurance Upgrade",selector:{grantedItemName:"Endurance Upgrade"},reusable:!1}],Snowbrawl:[{displayName:"Med Pack",selector:{grantedItemId:"medpack"},reusable:!0},{displayName:"Shield Can",selector:{grantedItemId:"shield-can"},reusable:!0}],"One Way Out":[{displayName:"Med Pack",selector:{grantedItemId:"medpack"},reusable:!0},{displayName:"Shield Can",selector:{grantedItemId:"shield-can"},reusable:!0}],Farmchain:{Seeds:[{displayName:"Corn Seed",selector:{grantedItemId:"yellow-seed"},reusable:!0},{displayName:"Wheat Seed",selector:{grantedItemId:"tan-seed",grantAction:"Grant Item"},reusable:!0},{displayName:"Potato Seed",selector:{grantedItemId:"brown-seed"},reusable:!0},{displayName:"Grape Seed",selector:{grantedItemId:"purple-seed"},reusable:!0},{displayName:"Raspberry Seed",selector:{grantedItemId:"magenta-seed"},reusable:!0},{displayName:"Watermelon Seed",selector:{grantedItemId:"green-seed"},reusable:!0},{displayName:"Coffee Bean",selector:{grantedItemId:"bronze-seed"},reusable:!0},{displayName:"Orange Seed",selector:{grantedItemId:"orange-seed"},reusable:!0},{displayName:"Gimberry Seed",selector:{grantedItemId:"gold-seed"},reusable:!0},{displayName:"Cash Berry Seed",selector:{grantedItemId:"dark-green-seed"},reusable:!0},{displayName:"Pepper Seed",selector:{grantedItemId:"red-seed"},reusable:!0},{displayName:"Energy Bar Seed",selector:{grantedItemId:"blue-seed"},reusable:!0},{displayName:"Lottery Ticket Seed",selector:{grantedItemId:"teal-seed"},reusable:!0}],"Seed Unlocks":[{displayName:"Wheat Seed Unlock",selector:{grantedItemName:"Wheat Seed Unlock"},reusable:!1},{displayName:"Potato Seed Unlock",selector:{grantedItemName:"Potato Seed Unlock"},reusable:!1},{displayName:"Grape Seed Unlock",selector:{grantedItemName:"Grape Seed Unlock"},reusable:!1},{displayName:"Raspberry Seed Unlock",selector:{grantedItemName:"Raspberry Seed Unlock"},reusable:!1},{displayName:"Watermelon Seed Unlock",selector:{grantedItemName:"Watermelon Seed Unlock"},reusable:!1},{displayName:"Coffee Bean Seed Unlock",selector:{grantedItemName:"Coffee Bean Seed Unlock"},reusable:!1},{displayName:"Orange Seed Unlock",selector:{grantedItemName:"Orange Seed Unlock"},reusable:!1},{displayName:"Gimberry Seed Unlock",selector:{grantedItemName:"Gimberry Seed Unlock"},reusable:!1}]}};class re{constructor(){this.name="Purchasers"}init(e){e.addEventListener("gameLoaded",(()=>{this.createButtons(e)}))}createButtons(e){var t,n,i,s,r;if(null===(r=null===(s=null===(i=null===(n=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===n?void 0:n.scene)||void 0===i?void 0:i.worldManager)||void 0===s?void 0:s.devices)||void 0===r?void 0:r.allDevices)for(let t in se)this.createGamemodeButtons(t,se[t],e.hud.createMenu("Cheats for gamemodes"));else setTimeout((()=>this.createButtons(e)),1e3)}createGamemodeButtons(e,t,n){var i,s,r,o,a,l,d;let h=null===(a=null===(o=null===(r=null===(s=null===(i=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===i?void 0:i.phaser)||void 0===s?void 0:s.scene)||void 0===r?void 0:r.worldManager)||void 0===o?void 0:o.devices)||void 0===a?void 0:a.allDevices,u=n.createGroup(e);if(Array.isArray(t))for(let e of t){let{selector:t,displayName:n,reusable:i}=e,s=h.filter((e=>{var n;let i=!0;for(let[s,r]of Object.entries(t))if((null===(n=e.options)||void 0===n?void 0:n[s])!=r){i=!1;break}return i}));if(0==s.length)continue;s.sort(((e,t)=>{var n,i;return(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.amountOfRequiredItem)-(null===(i=null==t?void 0:t.options)||void 0===i?void 0:i.amountOfRequiredItem)}));let r=`Purchase ${n} (${null===(d=null===(l=s[0])||void 0===l?void 0:l.options)||void 0===d?void 0:d.amountOfRequiredItem})`,o=u.addElement("button",{text:r});o.addEventListener("click",(()=>ie(this,void 0,void 0,(function*(){var e,t,a,l,d,u,c;(null===(t=null===(e=s[0])||void 0===e?void 0:e.interactiveZones)||void 0===t?void 0:t.onInteraction)?(null===(d=null===(l=null===(a=s[0])||void 0===a?void 0:a.interactiveZones)||void 0===l?void 0:l.onInteraction)||void 0===d||d.call(l),i||(yield new Promise((e=>setTimeout(e,500))),s[0].state.active||(s.shift(),0!=s.length?(r=`Purchase ${n} (${null===(c=null===(u=s[0])||void 0===u?void 0:u.options)||void 0===c?void 0:c.amountOfRequiredItem})`,o.text=r):o.remove()))):s=s.map((e=>h.find((t=>t.id==e.id))))}))))}else for(let[e,n]of Object.entries(t))this.createGamemodeButtons(e,n,u)}}const oe={menus:[{name:"Cheats for gamemodes",groups:[{name:"Farmchain",elements:[{type:"toggle",options:{textEnabled:"Stop auto harvesting",textDisabled:"Start auto harvesting",keybind:!0,keybindId:"autoHarvesting",default:!0,runFunction:"setAutoHarvest"}},{type:"toggle",options:{textEnabled:"Stop auto planting",textDisabled:"Start auto planting",keybind:!0,keybindId:"autoPlanting",default:!1,runFunction:"setAutoPlant"}}]}]}]},ae=["yellow-seed","tan-seed","brown-seed","purple-seed","magenta-seed","green-seed","bronze-seed","orange-seed","gold-seed","dark-green-seed","red-seed","blue-seed","teal-seed"];class le{constructor(){this.name="Farmchain",this.hudAddition=oe,this.autoHarvesting=!0,this.autoPlanting=!1,this.funcs=new Map([["setAutoHarvest",e=>{this.autoHarvesting=e}],["setAutoPlant",e=>{this.autoPlanting=e}]])}init(e){e.socketHandler.addEventListener("recieveChanges",(t=>{let n=t.detail;for(let t of n)for(let n in t.data){if(!n.endsWith("status")||"availableForCollection"!=t.data[n])continue;let i={key:"collect",deviceId:t.id,data:void 0};e.socketHandler.sendData("MESSAGE_FOR_DEVICE",i)}})),e.addEventListener("gameLoaded",(()=>{var t,n,i,s,r,o,a;let l=null===(r=null===(s=null===(i=null===(n=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===n?void 0:n.scene)||void 0===i?void 0:i.worldManager)||void 0===s?void 0:s.devices)||void 0===r?void 0:r.allDevices,d=l.filter((e=>"plant"==e.options.style)),h={};for(let e of l)ae.includes(null===(o=e.options)||void 0===o?void 0:o.ingredient1Item)&&(h[null===(a=e.options)||void 0===a?void 0:a.ingredient1Item]=e);setInterval((()=>{var t,n,i;if(!this.autoPlanting)return;let s,r=null===(i=null===(n=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.me)||void 0===n?void 0:n.inventory)||void 0===i?void 0:i.slots;if(!r)return;for(let e of ae)if(r.has(e)){s=e;break}if(!s)return;let o=d.findLast((e=>"idle"==e.state.status));e.socketHandler.sendData("MESSAGE_FOR_DEVICE",{key:"craft",deviceId:o.id,data:{recipe:h[s].id}})}),50)}))}}class de extends EventTarget{constructor(){super(),this.keybindManager=new y,this.funcs=new Map,this.scripts=[],window.cheat=this,this.socketHandler=new v(this),this.socketHandler.addEventListener("socket",(e=>{he.log("Socket connected",e)})),this.socketHandler.getSocket(),this.hud=new W(this),this.scripts=[new N,new ne,new F,new j,new q,new Q,new J,new Z,new ee,new le,new re],this.initScripts(),this.waitForLoad()}waitForLoad(){let e=setInterval((()=>{var t,n,i,s;let r=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.loading;(null==r?void 0:r.percentageAssetsLoaded)>=100&&(null==r?void 0:r.completedInitialLoad)&&(null==r?void 0:r.loadedInitialDevices)&&(null==r?void 0:r.loadedInitialTerrain)&&"__NO_TEAM_ID"!=(null===(s=null===(i=null===(n=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===n?void 0:n.phaser)||void 0===i?void 0:i.mainCharacter)||void 0===s?void 0:s.teamId)&&(clearInterval(e),this.log("Game Loaded"),this.dispatchEvent(new CustomEvent("gameLoaded")))}),1e3/60)}initScripts(){for(let e of this.scripts){if(e.funcs)for(let[t,n]of e.funcs)this.funcs.set(t,n);e.hudAddition&&this.hud.loadFromObject(e.hudAddition),e.init&&e.init(this)}}antifreeze(){let e=Object.freeze;Object.freeze=t=>{var n;return"WebSocket"==(null===(n=t.constructor)||void 0===n?void 0:n.name)||"WebSocket"==t.name?t:e(t)};var t=WebSocket.prototype.send;Object.defineProperty(WebSocket.prototype,"send",{configurable:!1,enumerable:!1,get:function(){return t},set:function(e){e!==t&&console.log("Attempted to modify WebSocket.prototype.send")}})}log(...e){console.log("[GC]",...e)}getScript(e){for(let t of this.scripts)if(t.name==e)return t;return null}}const he=new de;he.log("Loaded Gimkit Cheat version: 0.3.6"),he.antifreeze(),Object.isFrozen(WebSocket)&&alert("WebSocket object is still frozen. Please try refreshing the page. If this persists, open an issue on GitHub.")}();
